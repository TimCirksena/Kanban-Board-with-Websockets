<!DOCTYPE html>
<html>
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link href="styles/style.css" rel="stylesheet">
    <title>My Tiles Page</title>
    <style>
        /* add CSS for styling the tiles and dropdown menu */
    </style>
</head>
<body>
<h1>My Tiles Page</h1>
<button id="send-message-button">Send Message</button>
<button id="create-card-btn" onclick="createKanbanBoard()">Create Card</button>
<button onclick=" createDeletePopup('item1')">Delete Item1</button>

<div class="grid-container" id="existing-div">

</div>

<script>
    var socket = new WebSocket("ws://localhost:8080/landingPage");

    var id = 0;
    socket.onmessage = function (event) {
        //Sobald .sendText im WebSocket aufgerufen wird holt er sich die JSON
        var stubBoardDTO = JSON.parse(event.data);
        console.log(stubBoardDTO)
        var titel = stubBoardDTO.titel;
        var boardId = stubBoardDTO.boardId;
        createKanbanBoard(titel, boardId);
    }
    socket.onopen = function (){
        //Für initiales aufrufen
        socket.send("")
    }

    var sendMessageButton = document.getElementById("send-message-button");
    sendMessageButton.addEventListener("click", function () {
        var message = "Hello from the client!";
        socket.send(message);
    });

    function createKanbanBoard(titel, boardId) {
        // Create card element
        var card = document.createElement("div");
        card.classList.add("card");
        card.style.width = "25rem";
        card.id = "card" + id;
        id++;
        // Create card body
        var cardBody = document.createElement("div");
        cardBody.classList.add("card-body");
        card.appendChild(cardBody);

        // Create card link
        var cardLink1 = document.createElement("a");
        cardLink1.classList.add("card-link");
        cardLink1.href = "#";
        cardLink1.innerHTML = "Another link";
        var paddingLeft = document.createElement("div");
        paddingLeft.classList.add("padding-left-xl");
        paddingLeft.appendChild(cardLink1);
        cardBody.appendChild(paddingLeft);

        // Create card title
        var cardTitle = document.createElement("h1");
        cardTitle.classList.add("card-title");
        cardTitle.innerHTML = titel;
        cardBody.appendChild(cardTitle);

        // Create card link
        var cardLink2 = document.createElement("a");
        cardLink2.classList.add("card-link");
        cardLink2.href = "#";
        cardLink2.innerHTML = "/kanban/" + boardId;
        cardBody.appendChild(cardLink2);

        var existingDiv = document.getElementById("existing-div");
        existingDiv.appendChild(card);
    }
    /** Testung fürs deleten */
    function createDeletePopup(item) {
        // Create the pop-up
        var popup = document.createElement("div");
        popup.classList.add("popup");
        popup.innerHTML = "Are you sure you want to delete this item?";

        // Create the delete button
        var deleteBtn = document.createElement("button");
        deleteBtn.classList.add("delete-btn");
        deleteBtn.innerHTML = "Delete";
        deleteBtn.addEventListener("click", function () {
            // Delete the item
            // ...
            // Remove the pop-up
            document.body.removeChild(popup);
        });
        popup.appendChild(deleteBtn);

        // Create the cancel button
        var cancelBtn = document.createElement("button");
        cancelBtn.classList.add("cancel-btn");
        cancelBtn.innerHTML = "Cancel";
        cancelBtn.addEventListener("click", function () {
            // Remove the pop-up
            document.body.removeChild(popup);
        });
        popup.appendChild(cancelBtn);
    }

</script>
</body>
</html>
