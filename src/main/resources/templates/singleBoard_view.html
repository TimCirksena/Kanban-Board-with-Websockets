<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link href="style.css" rel="stylesheet">
    <title>My Tiles Page</title>
    <meta charset="UTF-8">
    <style>
        body {
            /* Prevent the user selecting text in the example */
            user-select: none;
        }

        #draggable {
            text-align: center;
            background: white;
        }

        .dropzone {
            display: inline-block;
            float: left;
            width: 200px;
            height: 500px;
            background: blueviolet;
            margin: 10px;
            padding: 10px;
        }

        .dropzone.dragover {
            background-color: purple;
        }

        .list-title {
            background-color: #f1f1f1;
            color: #333333;
            padding: 10px;
        }

        .dragging {
            opacity: 0.5;
        }

        .add-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 25px; /* half of width and height */
            background-color: blue;
            color: white;
            font-size: 30px;
            text-align: center;
            line-height: 50px;
            cursor: pointer;
        }

        .add-button:hover {
            background-color: darkblue;
        }
    </style>
</head>
<body>
<button id="add-button" class="add-button">+</button>
<div id="boardKanban">
    <h1>{boardTitel.titel}</h1>
    <div class="dropzone" id="droptarget2">

        <h2 class="list-title">titel Der Liste</h2>
        <label for="color-picker">Background color:
            <input type="color" id="color-picker" name="color-picker" style="width: 30px; height: 15px;">
        </label>
        <div class="draggable" draggable="true">This div is draggable</div>
        <div class="draggable" draggable="true">This div is draggable</div>
    </div>
    <div class="dropzone" id="droptarget">
        <h2 class="list-title">titel Der Liste2</h2>
        <label for="color-picker">Background color:
            <input type="color" id="color-picker1" name="color-picker" style="width: 30px; height: 15px;">
        </label>

    </div>
</div>
<script>
    let dragged;
    var id = 2;
    function dragzone() {
        /* events fired on the draggable target */
        const sources = document.querySelectorAll(".draggable");
        sources.forEach(source => {
            source.addEventListener("drag", (event) => {
                console.log("dragging");
            });
            source.addEventListener("dragstart", (event) => {
                // store a ref. on the dragged elem
                dragged = event.target;
                // make it half transparent
                event.target.classList.add("dragging");
            });
            source.addEventListener("dragend", (event) => {
                // reset the transparency
                event.target.classList.remove("dragging");
            });
        })
        /* events fired on the drop targets */
        //const target = document.getElementById("droptarget");
        const listTargets = document.querySelectorAll(".dropzone");
        listTargets.forEach(target => {
            target.addEventListener("dragover", (event) => {
                // prevent default to allow drop
                event.preventDefault();
            }, false);
            target.addEventListener("dragenter", (event) => {
                // highlight potential drop target when the draggable element enters it
                if (event.target.classList.contains("dropzone")) {
                    event.target.classList.add("dragover");
                }
            });
            target.addEventListener("dragleave", (event) => {
                // reset background of potential drop target when the draggable element leaves it
                if (event.target.classList.contains("dropzone")) {
                    event.target.classList.remove("dragover");
                }
            });
            target.addEventListener("drop", (event) => {
                // prevent default action (open as link for some elements)
                event.preventDefault();
                // move dragged element to the selected drop target
                if (event.target.classList.contains("dropzone")) {
                    event.target.classList.remove("dragover");
                    event.target.appendChild(dragged);
                }
            });
        })
    }

    //Colorpicker for elements that exist
    document.getElementById("color-picker").addEventListener("change", function () {
        var parent = this.parentElement.parentElement;
        parent.style.backgroundColor = this.value;
    });
    //New List-Item
    document.getElementById("add-button").addEventListener("click", function () {

        // Create new dropzone element
        var newDropzone = document.createElement("div");
        newDropzone.classList.add("dropzone");
        newDropzone.setAttribute("id", "color-picker" + id);
        id++;

        // Create new h2 element for the title
        var newTitle = document.createElement("h2");
        newTitle.classList.add("list-title");
        newTitle.innerHTML = "New List Title";

        // Create new label for color picker
        var colorPickerLabel = document.createElement("label");
        colorPickerLabel.setAttribute("for", "color-picker");
        colorPickerLabel.innerHTML = "Background color: ";

        // Create new color picker input
        var colorPickerInput = document.createElement("input");
        colorPickerInput.setAttribute("type", "color");
        colorPickerInput.setAttribute("id", "color-picker");
        colorPickerInput.setAttribute("name", "color-picker");
        colorPickerInput.setAttribute("style", "width: 30px; height: 15px;");
        colorPickerInput.addEventListener("change", function () {
            var parent = this.parentElement.parentElement;
            parent.style.backgroundColor = this.value;
        });

        // Append elements to new dropzone element
        newDropzone.appendChild(newTitle);
        newDropzone.appendChild(colorPickerLabel);
        colorPickerLabel.appendChild(colorPickerInput);

        // Append new dropzone element to boardKanban div
        document.getElementById("boardKanban").appendChild(newDropzone);
        dragzone();
    });



</script>
</body>
</html>